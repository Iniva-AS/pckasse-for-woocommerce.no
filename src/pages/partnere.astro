---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import PartnerCard from '../components/PartnerCard.astro';

// Fetch all partners
const allPartners = await getCollection('partners');

// Filter out drafts, prioritize featured partners
const partners = allPartners
	.filter((partner) => !partner.data.draft)
	.sort((a, b) => {
		// Featured partners first
		if (a.data.featured && !b.data.featured) return -1;
		if (!a.data.featured && b.data.featured) return 1;
		// Then alphabetically by title
		return a.data.title.localeCompare(b.data.title);
	});
---

<BaseLayout
	title="Partnere - PCKasse for WooCommerce"
	description="Finn profesjonelle partnere som kan hjelpe deg med oppsett og drift av PCKasse for WooCommerce."
>
	<Header currentPath={Astro.url.pathname} />

	<div class="bg-white px-6 py-24 sm:py-32 lg:px-8">
		<div class="mx-auto max-w-2xl text-center">
			<p class="text-base/7 font-semibold text-indigo-600">
				Få profesjonell hjelp til oppsett
			</p>
			<h1 class="mt-2 text-5xl font-semibold tracking-tight text-gray-900 sm:text-7xl">
				Våre partnere
			</h1>
			<p class="mt-8 text-lg font-medium text-pretty text-gray-500 sm:text-xl/8">
				Våre partnere er erfarne fagfolk som kan hjelpe deg med å komme i gang, sette opp integrasjonen, og gi løpende support.
			</p>
		</div>
	</div>

	<div class="bg-white pb-24 sm:pb-32">
		<div class="mx-auto max-w-7xl px-6 lg:px-8">
			<!-- Partners Grid -->
			{partners.length === 0 ? (
				<div class="text-center">
					<p class="text-gray-500">Vi legger til partnere fortløpende. Sjekk tilbake snart!</p>
				</div>
			) : (
				<div class="mx-auto grid max-w-2xl grid-cols-1 gap-8 lg:mx-0 lg:max-w-none lg:grid-cols-3">
					{partners.map((partner) => (
						<PartnerCard partner={partner} />
					))}
				</div>
			)}
		</div>
	</div>

	<!-- Partner CTA Section -->
	<div class="bg-white">
		<div class="mx-auto max-w-7xl py-24 sm:px-6 sm:py-32 lg:px-8">
			<div class="relative isolate overflow-hidden bg-gray-900 px-6 py-24 text-center shadow-2xl sm:rounded-3xl sm:px-16">
				<h2 class="text-4xl font-semibold tracking-tight text-balance text-white sm:text-5xl">
					Bli implementeringspartner
				</h2>
				<p class="mx-auto mt-6 max-w-xl text-lg/8 text-pretty text-gray-300">
					Er du utvikler eller byrå som jobber med WooCommerce og ERP-integrasjoner? Bli en offisiell PCKasse for WooCommerce-partner og få tilgang til et voksende marked av kunder som trenger profesjonell hjelp med oppsett, tilpasninger og vedlikehold.
				</p>
				<div class="mt-10 flex items-center justify-center gap-x-6">
					<a
						href="mailto:hello@iniva.no?subject=Partnerskap - PCKasse for WooCommerce"
						class="rounded-md bg-white px-3.5 py-2.5 text-sm font-semibold text-gray-900 shadow-xs hover:bg-gray-100 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white"
					>
						Søk om partnerskap
					</a>
				</div>
				<svg viewBox="0 0 1024 1024" aria-hidden="true" class="absolute top-1/2 left-1/2 -z-10 size-256 -translate-x-1/2 mask-[radial-gradient(closest-side,white,transparent)]">
					<circle r="512" cx="512" cy="512" fill="url(#827591b1-ce8c-4110-b064-7cb85a0b1217)" fill-opacity="0.7" />
					<defs>
						<radialGradient id="827591b1-ce8c-4110-b064-7cb85a0b1217">
							<stop stop-color="#7775D6" />
							<stop offset="1" stop-color="#E935C1" />
						</radialGradient>
					</defs>
				</svg>
			</div>
		</div>
	</div>

	<Footer />
</BaseLayout>
